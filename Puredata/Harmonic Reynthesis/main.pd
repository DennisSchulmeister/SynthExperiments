#N canvas 0 49 1920 1009 12;
#X obj -30 -30 preset_hub k12 1 %hidden%;
#N canvas 0 49 1920 1009 ui 0;
#X obj 400 200 cnv 15 960 510 empty empty empty 20 12 0 14 #e0eaf1
#404040 0;
#X obj 710 240 cnv 15 640 370 empty empty empty 20 12 0 14 #ffffff
#404040 0;
#N canvas 0 0 450 300 (subpatch) 0;
#X array soundfile 100 float 0 black black;
#X coords 0 1 99 -1 640 370 1;
#X restore 710 240 graph;
#X obj 410 210 bng 20 250 50 0 cmd-load-soundfile empty Load\ Soundfile
25 7 0 13 #fcfcfc #000000 #000000 1;
#X obj 410 370 bng 20 250 50 0 cmd-clear-all empty Clear\ All 25 7
0 13 #fcfcfc #000000 #000000 1;
#X obj 410 290 bng 20 250 50 0 cmd-analyze empty Anaylze 25 7 0 13
#fcfcfc #000000 #000000 1;
#X floatatom 1280 210 7 0 0 1 Hz - i-resyth-base-frequency 0 0 0,
f 7;
#N canvas 0 49 1920 1009 cmd-others 0;
#X text 10 10 Handle other commands;
#X obj 100 130 r cmd-load-soundfile;
#X text 100 100 ==== Load Soundfile ====;
#X obj 100 160 openpanel 0;
#X msg 100 190 read -resize \$1 soundfile;
#X obj 100 220 soundfiler;
#X text 400 100 ==== Play Soundfile ====;
#X obj 400 130 r cmd-play-soundfile;
#X obj 400 200 tabplay~ soundfile;
#X obj 400 230 throw~ output;
#X obj 900 150 savepanel;
#X msg 900 180 write \$1;
#X obj 1200 150 openpanel;
#X obj 900 210 s resynth-global;
#X msg 600 160 stop;
#X text 600 100 ==== Stop Playback ====;
#X obj 600 130 r cmd-stop-soundfile;
#X obj 140 280 samplerate~;
#X obj 100 340 s i-resynth-length-seconds;
#X obj 100 310 /;
#X obj 100 250 trigger f b;
#X text 900 90 ==== Save Analysis ====;
#X obj 900 120 r cmd-save-analysis;
#X text 1200 90 ==== Load Analysis ====;
#X obj 1200 120 r cmd-load-analysis;
#X obj 1200 180 list;
#X msg 1200 210 \; cmd-clear-analysis bang \; resynth-global read \$1
;
#X connect 1 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 20 0;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 10 0 11 0;
#X connect 11 0 13 0;
#X connect 12 0 25 0;
#X connect 14 0 8 0;
#X connect 16 0 14 0;
#X connect 17 0 19 1;
#X connect 19 0 18 0;
#X connect 20 0 19 0;
#X connect 20 1 17 0;
#X connect 22 0 10 0;
#X connect 24 0 12 0;
#X connect 25 0 26 0;
#X restore 1500 380 pd cmd-others;
#N canvas 0 49 1920 1009 cmd-analyze 0;
#X text 10 10 Do the frequency analysis;
#X obj 100 100 r cmd-analyze;
#X obj 100 150 trigger b b;
#N canvas 0 49 1920 1009 detect-pitch 0;
#X text 10 10 Detect fundamental pitch;
#X obj 100 100 inlet;
#X obj 100 380 outlet;
#X obj 300 180 samplerate~;
#X obj 140 270 sigmund~ -t pitch;
#X obj 140 300 mtof;
#X obj 140 330 s i-resynth-base-frequency;
#X obj 340 330 s p-resynth-base-frequency;
#X obj 140 180 value window_samples;
#X obj 140 210 pack f f;
#X obj 100 150 trigger b b b;
#X msg 140 240 list soundfile \$1 0 \$2 0;
#X connect 1 0 10 0;
#X connect 3 0 9 1;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 5 0 7 0;
#X connect 8 0 9 0;
#X connect 9 0 11 0;
#X connect 10 0 2 0;
#X connect 10 1 8 0;
#X connect 10 2 3 0;
#X connect 11 0 4 0;
#X restore 100 250 pd detect-pitch;
#N canvas 0 49 1920 1009 write-header 0;
#X obj 100 100 inlet;
#X obj 100 800 outlet;
#X obj 100 150 trigger b b;
#X obj 100 260 trigger b b;
#X obj 100 370 trigger b b;
#X obj 100 590 trigger b b;
#X obj 100 700 trigger b b;
#X msg 140 730 \; resynth-global add wait;
#X msg 140 430 \; resynth-global add init frequency \$1;
#X msg 140 650 \; resynth-global add init frame-ms \$1;
#X obj 140 180 value seconds;
#X obj 140 290 value frames;
#X obj 140 400 value frequency;
#X obj 140 620 value frame_ms;
#X text 10 10 Write initialization header with static analysis parameters.
;
#X text 10 40 NOTE: Dynamic playback parameters will be written on
file save \, only., f 60;
#X msg 140 210 \; resynth-global add init seconds \$1;
#X msg 140 320 \; resynth-global add init frames \$1;
#X obj 100 480 trigger b b;
#X obj 140 510 value window_samples;
#X msg 140 540 \; resynth-global add init window-samples \$1;
#X connect 0 0 2 0;
#X connect 2 0 3 0;
#X connect 2 1 10 0;
#X connect 3 0 4 0;
#X connect 3 1 11 0;
#X connect 4 0 18 0;
#X connect 4 1 12 0;
#X connect 5 0 6 0;
#X connect 5 1 13 0;
#X connect 6 0 1 0;
#X connect 6 1 7 0;
#X connect 10 0 16 0;
#X connect 11 0 17 0;
#X connect 12 0 8 0;
#X connect 13 0 9 0;
#X connect 18 0 5 0;
#X connect 18 1 19 0;
#X connect 19 0 20 0;
#X restore 100 310 pd write-header;
#N canvas 0 49 1920 1009 generate-frames 0;
#X text 10 10 Generate frames with harmonic coefficients;
#X obj 100 100 inlet;
#X obj 100 2350 outlet;
#N canvas 0 0 450 300 (subpatch) 0;
#X array analysis_frame 1024 float 1 black black;
#A 0 -3.05176e-05 -3.05176e-05 6.10352e-05 -6.10352e-05 6.10352e-05
-6.10352e-05 6.10352e-05 -6.10352e-05 3.05176e-05 0 0 -3.05176e-05
3.05176e-05 0 -3.05176e-05 6.10352e-05 -9.15527e-05 6.10352e-05 0 0
0 0 -3.05176e-05 6.10352e-05 -6.10352e-05 6.10352e-05 -6.10352e-05
6.10352e-05 -6.10352e-05 6.10352e-05 -6.10352e-05 3.05176e-05 3.05176e-05
-6.10352e-05 6.10352e-05 -6.10352e-05 3.05176e-05 3.05176e-05 -6.10352e-05
9.15527e-05 -0.00012207 9.15527e-05 -3.05176e-05 0 3.05176e-05 -6.10352e-05
6.10352e-05 -6.10352e-05 6.10352e-05 -3.05176e-05 0 0 0 0 3.05176e-05
-6.10352e-05 6.10352e-05 -6.10352e-05 6.10352e-05 -3.05176e-05 0 3.05176e-05
-9.15527e-05 9.15527e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05 -3.05176e-05
-3.05176e-05 -3.05176e-05;
#X coords 0 1 1023 -1 400 200 1;
#X restore 900 600 graph;
#X obj 130 450 ./utils/for-loop;
#X obj 340 510 print Analyzing frame;
#X obj 130 420 pack f f;
#X text 170 560 ---- Copy samples for current frame into buffer ----
;
#X obj 190 750 ./utils/for-loop;
#X obj 190 720 pack f f;
#X msg 190 690 0;
#X obj 100 170 trigger b b;
#X text 110 310 ---- Analyze individual frames ----;
#X obj 220 840 + 1;
#X obj 220 870 tabread soundfile;
#X obj 220 810 float;
#X obj 220 780 bang;
#X obj 100 330 trigger b b;
#X obj 130 360 trigger b b b, f 61;
#X msg 550 780 -1;
#X text 260 450 (for each frame);
#X text 320 750 (for each sample);
#X text 590 780 (read soundfile from beginning);
#X obj 220 900 trigger f b;
#X obj 360 940 float;
#X obj 360 970 + 1;
#X msg 470 910 -1;
#X text 510 911 (write buffer from beginning);
#X obj 160 580 trigger b b;
#X obj 340 1190 samplerate~;
#X obj 220 1000 tabwrite analysis_frame;
#X msg 220 640 \; analysis_frame const 0;
#X obj 190 610 trigger b b b b, f 41;
#X obj 190 1310 unpack f f f, f 24;
#X text 400 1280 Harmonic Nr. \, Frequency \, Amplitude \, Cosine \,
Sine;
#X text 170 1050 ---- Find harmonics in current frame ----;
#X obj 190 1400 text insert analysis_harmonics 1e+09;
#X obj 190 1370 pack f f, f 24;
#X obj 160 1070 trigger b b;
#X text 170 1910 ---- Write harmonic coefficients ---;
#X obj 740 2150 text sequence analysis_harmonics;
#X msg 160 2280 \; resynth-global add wait;
#X obj 160 1930 trigger b b;
#X obj 190 1960 value frame_number;
#X msg 190 1990 \; resynth-global add frame \$1;
#X obj 200 510 value frame_number;
#X obj 160 480 trigger b f f;
#X obj 740 2250 float;
#X obj 740 2280 + 1;
#X msg 990 2220 0;
#X obj 740 2180 trigger b a, f 16;
#X obj 740 2310 list append, f 16;
#X obj 700 2090 trigger b b b, f 42;
#X text 1030 2220 (reset harmonic number);
#X msg 740 2120 line 0 \, auto;
#X msg 740 2340 \; resynth-global add harmonic \$1 \$2 \$3;
#X msg 130 390 0;
#X obj 170 390 expr ceil(frames) - 1;
#X msg 140 240 \; analysis_frame resize \$1;
#X text 110 150 ---- Reset internal buffer ----;
#X obj 140 210 value window_samples;
#X obj 240 690 value window_samples;
#X msg 190 1250 list analysis_frame \$1 0 \$2 0;
#X obj 190 1190 value window_samples;
#X obj 160 1160 trigger b b b;
#X obj 190 1220 pack f f;
#X obj 190 1340 expr rint($f1 / frequency);
#X obj 190 1280 sigmund~ -t -npeak 64 peaks;
#X obj 160 1470 trigger b b;
#X text 170 1450 ---- Combine rounded harmincs with the same ratio
and limit to 16 harmonics ----, f 82;
#X obj 200 1610 text sequence analysis_harmonics;
#X msg 200 1580 line 0 \, auto;
#N canvas 0 0 450 300 (subpatch) 0;
#X array harmonics 16 float 7 #e5cdcd black;
#A 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
#X coords 0 1 16 0 320 200 1;
#X restore 900 1600 graph;
#X msg 240 1530 \; harmonics const 0;
#X obj 200 1500 trigger b b;
#X text 400 1370 Ratio \, Amplitude;
#X obj 200 1790 tabread harmonics;
#X obj 200 1640 unpack f f, f 11;
#X obj 200 1820 +;
#X obj 200 1850 tabwrite harmonics, f 36;
#X obj 200 1760 spigot;
#X obj 300 1670 s \$0-amplitude;
#X obj 240 1820 r \$0-amplitude;
#X obj 200 1670 - 1;
#X obj 240 1730 expr \\$f1 >= 0 && \\$f1 <= 15;
#X obj 200 1700 trigger f f f, f 36;
#X text 500 1730 <--- Harmonic 1 … 16;
#X text 500 1340 <--- Round harmonic ratio;
#X obj 200 2090 ./utils/for-loop 0 15;
#X obj 270 2180 tabread harmonics;
#X obj 160 2060 trigger b b;
#X text 500 2090 <--- Harmonic 1 … 16;
#X msg 200 2210 \; resynth-global add harmonic \$1 \$1 \$2;
#X obj 200 2180 pack f f;
#X obj 200 2120 trigger f f;
#X obj 200 2150 + 1;
#X obj 190 1130 text define analysis_harmonics;
#X msg 190 1101 clear;
#X connect 1 0 11 0;
#X connect 4 0 46 0;
#X connect 6 0 4 0;
#X connect 8 0 16 0;
#X connect 9 0 8 0;
#X connect 10 0 9 0;
#X connect 11 0 17 0;
#X connect 11 1 60 0;
#X connect 13 0 15 1;
#X connect 13 0 14 0;
#X connect 14 0 23 0;
#X connect 15 0 13 0;
#X connect 16 0 15 0;
#X connect 17 0 2 0;
#X connect 17 1 18 0;
#X connect 18 0 56 0;
#X connect 18 1 57 0;
#X connect 18 2 19 0;
#X connect 19 0 15 1;
#X connect 23 0 30 0;
#X connect 23 1 24 0;
#X connect 24 0 25 0;
#X connect 25 0 24 1;
#X connect 25 0 30 1;
#X connect 26 0 24 1;
#X connect 28 0 38 0;
#X connect 28 1 32 0;
#X connect 29 0 65 1;
#X connect 32 0 10 0;
#X connect 32 1 31 0;
#X connect 32 2 61 0;
#X connect 32 3 26 0;
#X connect 33 1 66 0;
#X connect 33 2 37 1;
#X connect 37 0 36 0;
#X connect 38 0 64 0;
#X connect 38 1 97 0;
#X connect 40 0 50 0;
#X connect 42 0 90 0;
#X connect 42 1 43 0;
#X connect 43 0 44 0;
#X connect 46 0 28 0;
#X connect 46 1 45 0;
#X connect 46 2 5 0;
#X connect 47 0 48 0;
#X connect 48 0 47 1;
#X connect 48 0 51 0;
#X connect 49 0 47 1;
#X connect 50 0 47 0;
#X connect 50 1 51 1;
#X connect 51 0 55 0;
#X connect 52 1 54 0;
#X connect 52 2 49 0;
#X connect 54 0 40 0;
#X connect 56 0 6 0;
#X connect 57 0 6 1;
#X connect 60 0 58 0;
#X connect 61 0 9 1;
#X connect 62 0 67 0;
#X connect 63 0 65 0;
#X connect 64 0 68 0;
#X connect 64 1 63 0;
#X connect 64 2 29 0;
#X connect 65 0 62 0;
#X connect 66 0 37 0;
#X connect 67 0 33 0;
#X connect 68 0 42 0;
#X connect 68 1 74 0;
#X connect 70 0 77 0;
#X connect 71 0 70 0;
#X connect 74 0 71 0;
#X connect 74 1 73 0;
#X connect 76 0 78 0;
#X connect 77 0 83 0;
#X connect 77 1 81 0;
#X connect 78 0 79 0;
#X connect 80 0 76 0;
#X connect 82 0 78 1;
#X connect 83 0 85 0;
#X connect 84 0 80 1;
#X connect 85 0 80 0;
#X connect 85 1 84 0;
#X connect 85 2 79 1;
#X connect 88 0 94 0;
#X connect 89 0 93 1;
#X connect 90 0 41 0;
#X connect 90 1 88 0;
#X connect 93 0 92 0;
#X connect 94 0 95 0;
#X connect 94 1 89 0;
#X connect 95 0 93 0;
#X connect 97 0 96 0;
#X restore 100 340 pd generate-frames;
#N canvas 0 49 1920 1009 calc-frame-count 0;
#X obj 100 100 inlet;
#X text 10 10 Calculate the number of frames;
#X obj 100 220 outlet;
#X obj 110 191 s i-resynth-length-frames;
#X obj 100 130 trigger b b;
#X obj 110 160 expr seconds * 1000 / frame_ms;
#X connect 0 0 4 0;
#X connect 4 0 2 0;
#X connect 4 1 5 0;
#X connect 5 0 3 0;
#X restore 100 280 pd calc-frame-count;
#X msg 140 180 \; cmd-clear-analysis-result bang;
#X msg 100 370 \; resynth-global update bang;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 2 1 7 0;
#X connect 3 0 6 0;
#X connect 4 0 5 0;
#X connect 5 0 8 0;
#X connect 6 0 4 0;
#X restore 1500 350 pd cmd-analyze;
#X obj 410 310 bng 20 250 50 0 cmd-save-analysis empty Save\ Analysis
25 7 0 13 #fcfcfc #000000 #000000 1;
#X obj 410 330 bng 20 250 50 0 cmd-load-analysis empty Load\ Analysis
25 7 0 13 #fcfcfc #000000 #000000 1;
#X msg -100 270 set \$1;
#X obj 1500 230 loadbang;
#X obj 410 230 bng 20 250 50 0 cmd-play-soundfile empty Play\ Soundfile
25 7 0 13 #fcfcfc #000000 #000000 1;
#X obj 1500 780 dac~;
#X msg 1240 150 set \$1;
#X text 410 620 Speed:;
#X floatatom 490 620 7 0 0 2 - - p-resynth-speed 0 0 1, f 7;
#X msg 210 480 set \$1;
#X obj 210 450 r p-resynth-speed;
#N canvas 0 49 1920 1009 cmd-clear 0;
#X obj 700 100 r clear-soundfile;
#X text 100 70 ==== Clear Data ====;
#X obj 540 100 r cmd-clear-all;
#X msg 700 130 \; soundfile const 0 \; soundfile resize 100 \; i-resynth-length-seconds
0 \;;
#X obj 100 100 r cmd-clear-analysis-result;
#X obj 340 100 r cmd-clear-analysis;
#X msg 100 140 \; resynth-global clear \; i-resynth-base-frequency
0 \; i-resynth-length-frames 0;
#X msg 340 140 \; p-resynth-frame-ms 100 \; p-resynth-base-frequency
0 \; p-resynth-speed 1 \; p-resynth-loop-start-frame 0 \; p-resynth-loop-end-frame
0 \; p-resynth-release-frame 0 \;;
#X connect 0 0 3 0;
#X connect 2 0 3 0;
#X connect 2 0 7 0;
#X connect 2 0 6 0;
#X connect 4 0 6 0;
#X connect 5 0 6 0;
#X connect 5 0 7 0;
#X restore 1500 320 pd cmd-clear;
#N canvas 0 49 1920 1009 resynth-global 0;
#X text 10 10 Global buffer for the resynthesis sequencer. This one
writes the result files and sets the global parameters. The other ones
control their respective oscillator.;
#X obj 100 100 r resynth-global;
#X obj 100 190 text define resynthesis;
#X text 280 190 Sequence data (click to edit);
#X msg 100 160 clear;
#N canvas 0 49 1920 1009 read 0;
#X obj 100 100 inlet;
#X obj 150 260 outlet;
#X text 10 10 Load analysis file into the text object \, interpret
all init messages at the beginning and then remove the playback parameters
as they maybe changed in the UI and will be rewritten whan the file
is saved., f 72;
#X obj 150 200 list;
#X msg 150 230 read -c \$1;
#X obj 100 170 trigger b a;
#X obj 900 550 s i-resynth-length-seconds;
#X obj 970 520 s i-resynth-length-frames;
#X obj 1060 490 s i-resynth-base-frequency;
#X obj 1140 460 s p-resynth-frame-ms;
#X obj 1450 340 s p-resynth-speed;
#X obj 900 190 route init;
#X obj 1690 250 s p-resynth-release-frame;
#X text 900 100 ==== Message handling ====;
#X text 110 150 ---- Read in analysis file ----;
#X text 110 310 ---- Read and remove playback parameters ----;
#X text 110 680 ---- Read analysis parameters ----;
#X obj 100 330 trigger b b;
#X obj 140 420 text sequence resynthesis -w wait;
#X obj 140 360 until;
#X obj 140 820 text sequence resynthesis -w wait;
#X obj 140 760 until;
#X msg 140 790 step;
#X obj 900 130 r \$0-rs-message;
#X obj 140 850 s \$0-rs-message;
#X obj 270 850 s \$0-rs-stop-loop;
#X obj 190 760 r \$0-rs-stop-loop;
#X obj 140 730 trigger b b;
#X msg 340 760 line 0;
#X msg 140 510 0;
#X obj 140 539 text delete resynthesis;
#X obj 140 450 trigger b a;
#X obj 180 480 s \$0-rs-message;
#X obj 240 450 s \$0-rs-stop-loop;
#X obj 190 360 r \$0-rs-stop-loop;
#X msg 140 390 line 0 \, step;
#X obj 100 570 trigger b b;
#X msg 140 600 0;
#X obj 140 629 text delete resynthesis;
#X obj 900 160 list trim;
#X obj 1530 310 s p-resynth-loop-start-frame;
#X obj 1610 280 s p-resynth-loop-end-frame;
#X text 110 900 ---- Update line counters ----;
#X obj 100 700 trigger b b;
#X msg 100 920 \; resynth-global update bang;
#X obj 1220 430 s p-resynth-window-samples;
#X obj 1370 370 value detune;
#X obj 900 220 route seconds frames frequency frame-ms window-samples
frequency1 detune speed loop-start-frame loop-end-frame release-frame
, f 125;
#X obj 1300 400 s p-resynth-base-frequency;
#X connect 0 0 5 0;
#X connect 3 0 4 0;
#X connect 4 0 1 0;
#X connect 5 0 17 0;
#X connect 5 1 3 0;
#X connect 11 0 47 0;
#X connect 17 0 36 0;
#X connect 17 1 19 0;
#X connect 18 0 31 0;
#X connect 18 1 33 0;
#X connect 18 2 33 0;
#X connect 19 0 35 0;
#X connect 20 0 24 0;
#X connect 20 1 25 0;
#X connect 20 2 25 0;
#X connect 21 0 22 0;
#X connect 22 0 20 0;
#X connect 23 0 39 0;
#X connect 26 0 21 1;
#X connect 27 0 21 0;
#X connect 27 1 28 0;
#X connect 28 0 20 0;
#X connect 29 0 30 0;
#X connect 31 0 29 0;
#X connect 31 1 32 0;
#X connect 34 0 19 1;
#X connect 35 0 18 0;
#X connect 36 0 43 0;
#X connect 36 1 37 0;
#X connect 37 0 38 0;
#X connect 39 0 11 0;
#X connect 43 0 44 0;
#X connect 43 1 27 0;
#X connect 47 0 6 0;
#X connect 47 1 7 0;
#X connect 47 2 8 0;
#X connect 47 3 9 0;
#X connect 47 4 45 0;
#X connect 47 5 48 0;
#X connect 47 6 46 0;
#X connect 47 7 10 0;
#X connect 47 8 40 0;
#X connect 47 9 41 0;
#X connect 47 10 12 0;
#X restore 170 160 pd read;
#N canvas 0 49 1920 1009 add 0;
#X obj 100 100 inlet;
#X obj 100 130 list;
#X obj 100 160 text insert resynthesis 1e+09;
#X text 10 10 Append line to the text object;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X restore 340 160 pd add;
#N canvas 0 49 1920 1009 write 0;
#X text 10 10 Prepend dynamic playback parameters \, save text file
and remove the dynamic parameters again. This makes sure that always
the most-recent parameters are saved whithout the need to run a full
anaysis on each change.;
#X obj 140 530 value speed;
#X obj 140 650 value loop_start_frame;
#X obj 140 770 value loop_end_frame;
#X obj 140 890 value release_frame;
#X obj 140 1110 outlet;
#X obj 100 100 inlet;
#X obj 100 500 trigger a b;
#X obj 100 620 trigger a b;
#X obj 100 740 trigger a b;
#X obj 100 860 trigger a b;
#X msg 140 1080 write -c \$1;
#X text 110 150 ---- Prepend playback parameters ----;
#X text 110 1000 ---- Write file ----;
#X text 110 1160 ---- Remove playback parameters again ----;
#X obj 100 1020 trigger b a;
#X obj 140 1050 list;
#X obj 100 170 trigger a b;
#X msg 100 1180 0 \, 0 \, 0 \, 0 \, 0;
#X obj 100 1209 text delete resynthesis;
#X msg 140 200 list wait;
#X msg 140 560 list init speed \$1;
#X msg 140 680 list init loop-start-frame \$1;
#X msg 140 800 list init loop-end-frame \$1;
#X msg 140 920 list init release-frame \$1;
#X obj 140 230 text insert resynthesis;
#X obj 140 590 text insert resynthesis;
#X obj 140 710 text insert resynthesis;
#X obj 140 830 text insert resynthesis;
#X obj 140 950 text insert resynthesis;
#X obj 100 260 trigger a b;
#X obj 140 350 text insert resynthesis;
#X obj 140 290 value detune;
#X msg 140 320 list init detune \$1;
#X obj 100 380 trigger a b;
#X obj 140 470 text insert resynthesis;
#X obj 140 410 value frequency1;
#X msg 140 440 list init frequency1 \$1;
#X connect 1 0 21 0;
#X connect 2 0 22 0;
#X connect 3 0 23 0;
#X connect 4 0 24 0;
#X connect 6 0 17 0;
#X connect 7 0 8 0;
#X connect 7 1 1 0;
#X connect 8 0 9 0;
#X connect 8 1 2 0;
#X connect 9 0 10 0;
#X connect 9 1 3 0;
#X connect 10 0 15 0;
#X connect 10 1 4 0;
#X connect 11 0 5 0;
#X connect 15 0 18 0;
#X connect 15 1 16 0;
#X connect 16 0 11 0;
#X connect 17 0 30 0;
#X connect 17 1 20 0;
#X connect 18 0 19 0;
#X connect 20 0 25 0;
#X connect 21 0 26 0;
#X connect 22 0 27 0;
#X connect 23 0 28 0;
#X connect 24 0 29 0;
#X connect 30 0 34 0;
#X connect 30 1 32 0;
#X connect 32 0 33 0;
#X connect 33 0 31 0;
#X connect 34 0 7 0;
#X connect 34 1 36 0;
#X connect 36 0 37 0;
#X connect 37 0 35 0;
#X restore 250 160 pd write;
#X obj 100 130 route clear read write add update;
#N canvas 0 49 1920 1009 update_line_counters 0;
#X obj 600 70 inlet;
#X text 10 10 Loop through the sequence and find the lines for the
loop points and where the release segment starts., f 68;
#X obj 640 230 value _\$0_current_frame;
#X obj 600 390 text sequence resynthesis -w wait;
#X obj 1040 230 value loop_start_line;
#X msg 860 200 -1;
#X obj 600 170 trigger b b b;
#X text 10 60 Sets the following global values:, f 68;
#X text 10 90 - loop_start_line: Sequence line with loop start point
, f 68;
#X text 10 110 - relase_line: Sequence line with start of the relese
segment, f 68;
#X obj 860 230 value _\$0_current_line;
#X text 10 140 Missing values will be initialized with -1, f 68;
#X obj 1210 230 value release_line;
#X obj 670 500 expr _\$0_current_line + 1;
#X obj 670 529 value _\$0_current_line;
#X obj 670 790 expr _\$0_current_frame == loop_start_frame, f 43;
#X obj 630 760 trigger b b;
#X obj 630 1010 trigger b b;
#X obj 670 850 bang;
#X obj 670 879 value _\$0_current_line;
#X obj 670 940 value loop_start_line;
#X obj 670 1100 bang;
#X obj 670 1129 value _\$0_current_line;
#X obj 670 1190 value release_line;
#X obj 670 1070 moses 1;
#X obj 670 820 moses 1;
#X floatatom 670 910 5 0 0 1 loop_start_line - - 0 0 1, f 5;
#X floatatom 670 1160 5 0 0 1 release_line - - 0 0 1, f 5;
#X obj 670 1040 expr _\$0_current_frame == release_frame;
#X obj 600 100 bng 20 250 50 0 empty empty empty 17 7 0 10 #fcfcfc
#000000 #000000 1;
#X obj 600 360 until;
#X obj 600 300 trigger b b;
#X msg 690 330 line 0;
#X msg 640 200 -1;
#X obj 630 600 list trim;
#X obj 630 630 route frame;
#X obj 630 660 trigger b f;
#X obj 670 690 value _\$0_current_frame;
#X text 610 280 ---- Iterate over all text lines ----;
#X text 610 150 ---- Initialize variables ----;
#X text 640 450 ---- Increase line counter ----;
#X obj 630 470 trigger a b;
#X text 640 580 ---- Detect new frame ----;
#X text 720 630 <--- frame X;
#X text 640 740 ---- Find loop start frame ----;
#X text 640 990 ---- Find release frame ----;
#X obj 630 420 trigger a;
#X connect 0 0 29 0;
#X connect 3 0 46 0;
#X connect 3 1 13 0;
#X connect 3 2 30 1;
#X connect 5 0 4 0;
#X connect 5 0 10 0;
#X connect 5 0 12 0;
#X connect 6 0 31 0;
#X connect 6 1 33 0;
#X connect 6 2 5 0;
#X connect 13 0 14 0;
#X connect 15 0 25 0;
#X connect 16 0 17 0;
#X connect 16 1 15 0;
#X connect 17 1 28 0;
#X connect 18 0 19 0;
#X connect 19 0 26 0;
#X connect 21 0 22 0;
#X connect 22 0 27 0;
#X connect 24 1 21 0;
#X connect 25 1 18 0;
#X connect 26 0 20 0;
#X connect 27 0 23 0;
#X connect 28 0 24 0;
#X connect 29 0 6 0;
#X connect 30 0 3 0;
#X connect 31 0 30 0;
#X connect 31 1 32 0;
#X connect 32 0 3 0;
#X connect 33 0 2 0;
#X connect 34 0 35 0;
#X connect 35 0 36 0;
#X connect 36 0 16 0;
#X connect 36 1 37 0;
#X connect 41 0 34 0;
#X connect 41 1 13 0;
#X connect 46 0 41 0;
#X restore 420 160 pd update_line_counters;
#X obj 1230 100 r i-resynth-base-frequency;
#X obj 1010 100 r p-resynth-base-frequency;
#X text 1230 80 Detected frequency;
#X text 1010 80 Manually adjusted frequency;
#X floatatom 1230 130 5 0 0 0 - - - 0 0 1, f 5;
#X floatatom 1010 130 5 0 0 0 - - - 0 0 1, f 5;
#X obj 1010 200 /;
#X floatatom 1010 230 5 0 0 0 - - - 0 0 1, f 5;
#X obj 1010 260 value detune;
#X obj 1230 160 trigger b f;
#X connect 1 0 8 0;
#X connect 4 0 2 0;
#X connect 5 0 2 0;
#X connect 7 0 2 0;
#X connect 8 0 4 0;
#X connect 8 1 5 0;
#X connect 8 2 7 0;
#X connect 8 3 6 0;
#X connect 8 4 9 0;
#X connect 10 0 14 0;
#X connect 11 0 15 0;
#X connect 14 0 19 0;
#X connect 15 0 16 0;
#X connect 16 0 17 0;
#X connect 17 0 18 0;
#X connect 19 0 16 0;
#X connect 19 1 16 1;
#X restore 1500 410 pd resynth-global;
#X obj 1500 610 mtof;
#X obj 1650 610 / 127;
#X floatatom 1500 640 6 0 0 1 Frequency - - 0 0 1, f 6;
#X floatatom 1650 639 6 0 0 1 Velocity - - 0 0 1, f 6;
#X floatatom 1500 580 5 0 0 0 - - - 0 0 1, f 5;
#X obj 1500 550 notein 1;
#X obj 1800 582 ctlin 64 1;
#X obj 1500 700 clone oscillator 8;
#X text 1500 520 ==== Mini Synthesizer for preview playing ====;
#X text 1500 200 ==== GUI Handling ====;
#X obj 1800 611 / 127;
#X floatatom 1800 640 5 0 0 1 Sustain - - 0 0 1, f 5;
#X floatatom 660 620 5 0 0 2 - - p-resynth-loop-start-frame 0 0 1,
f 5;
#X floatatom 660 650 5 0 0 2 - - p-resynth-loop-end-frame 0 0 1, f
5;
#X text 840 210 Length:;
#X floatatom 900 210 10 0 0 1 Seconds - - 0 0 0, f 10;
#X floatatom 1040 210 5 0 0 1 Frames - - 0 0 0, f 5;
#X msg 140 670 set \$1;
#X msg 140 760 set \$1;
#X obj 1240 120 r i-resynth-base-frequency;
#X msg 790 150 set \$1;
#X obj 790 120 r i-resynth-length-seconds;
#X msg 1000 150 set \$1;
#X obj 1000 90 r i-resynth-length-frames;
#X obj 410 420 cnv 15 1 1 empty empty Analysis\ Parameters 0 0 0 14
#e0e0e0 #780a0a 0;
#X obj 410 600 cnv 15 1 1 empty empty Playback\ Parameters 0 0 0 14
#e0e0e0 #780a0a 0;
#X obj 710 210 cnv 15 1 1 empty empty Information 0 7 0 14 #e0e0e0
#780a0a 0;
#X obj 1660 700 catch~ output;
#X obj 1500 259 s cmd-clear-all;
#X obj 410 250 bng 20 250 50 0 cmd-stop-soundfile empty Stop\ Playback
25 7 0 13 #fcfcfc #000000 #000000 1;
#X obj 850 150 value seconds;
#X obj 1110 120 value frames;
#X obj 270 480 value speed;
#X text 410 500 The analysis will detect the frequency and amplitude
of 16 harmonics for every frame. You can preview the resynthesized
sound via MIDI and load the anaylsis result into Mini Clavier., f
40;
#X floatatom 660 680 5 0 0 0 - - p-resynth-release-frame 0 0 1, f
5;
#X text 570 620 Loop Start:;
#X text 570 650 Loop End:;
#X text 570 680 Release:;
#X msg 140 840 set \$1;
#X obj 140 810 r p-resynth-release-frame;
#X obj 140 640 r p-resynth-loop-start-frame;
#X obj 140 730 r p-resynth-loop-end-frame;
#X obj 200 670 value loop_start_frame;
#X obj 200 760 value loop_end_frame;
#X obj 200 840 value release_frame;
#X obj 400 790 r i-resynth-length-frames;
#X msg 400 850 range 0 \$1;
#X text 800 800 ==== Show frames in graph ====;
#X obj 800 890 samplerate~;
#X obj 800 830 r p-resynth-frame-ms;
#X obj 800 920 expr \\$f1 / 1000 * \\$f2;
#X obj 800 860 trigger b f;
#X msg 800 954 \; soundfile xticks 0 \$1 1;
#X obj 1000 120 expr ceil($f1);
#X obj 710 620 hsl 635 20 0 50.1133 0 0 p-resynth-loop-start-frame
empty empty -2 -8 0 10 #fcfcfc #000000 #000000 0 1 0 1;
#X obj 710 650 hsl 635 20 0 50.1133 0 0 p-resynth-loop-end-frame empty
empty -2 -8 0 10 #fcfcfc #000000 #000000 0 1 0 1;
#X obj 710 680 hsl 635 20 0 50.1133 0 0 p-resynth-release-frame empty
empty -2 -8 0 10 #fcfcfc #000000 #000000 0 1 0 1;
#N canvas 0 49 1920 1009 round-frame-parameters 0;
#X obj 200 200 r p-resynth-loop-start-frame;
#X obj 200 319 expr round(loop_start_frame);
#X obj 240 380 s p-resynth-loop-start-frame;
#X obj 200 230 change;
#X obj 200 260 bang;
#X obj 200 290 delay 1000;
#X text 10 10 Round frame parameters to whole integers (waits a second
after a change and then tries to change the value exactly once \, hopefully
without causing an endless loop), f 65;
#X obj 600 230 change;
#X obj 600 260 bang;
#X obj 600 290 delay 1000;
#X obj 600 200 r p-resynth-loop-end-frame;
#X obj 600 319 expr round(loop_end_frame);
#X obj 640 380 s p-resynth-loop-end-frame;
#X obj 1000 232 change;
#X obj 1000 262 bang;
#X obj 1000 292 delay 1000;
#X obj 1000 200 r p-resynth-release-frame;
#X obj 1000 321 expr round(release_frame);
#X obj 1040 382 s p-resynth-release-frame;
#X obj 200 350 trigger b f;
#X obj 600 350 trigger b f;
#X obj 1000 350 trigger b f;
#X msg 200 410 \; resynth-global update bang;
#X msg 600 410 \; resynth-global update bang;
#X msg 1000 410 \; resynth-global update bang;
#X text 10 70 Also makes the global resynthesizer sub-patch update
the internal line counters after a frame number has been changed.,
f 65;
#X connect 0 0 3 0;
#X connect 1 0 19 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 1 0;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 9 0 11 0;
#X connect 10 0 7 0;
#X connect 11 0 20 0;
#X connect 13 0 14 0;
#X connect 14 0 15 0;
#X connect 15 0 17 0;
#X connect 16 0 13 0;
#X connect 17 0 21 0;
#X connect 19 0 22 0;
#X connect 19 1 2 0;
#X connect 20 0 23 0;
#X connect 20 1 12 0;
#X connect 21 0 24 0;
#X connect 21 1 18 0;
#X restore 1500 440 pd round-frame-parameters;
#X obj 400 820 expr max($f1 \, 1);
#X obj 1500 670 ./utils/poly-sustain 8 1;
#X obj 1500 730 *~ 0.25;
#X floatatom 490 650 7 0 0 1 Hz - p-resynth-base-frequency 0 0 1,
f 7;
#X obj 140 530 r p-resynth-base-frequency;
#X text 1200 210 Frequency:;
#X text 410 650 Frequency:;
#X msg 140 560 set \$1;
#X text 410 440 Window Size:;
#X obj -100 150 r p-resynth-window-samples;
#X obj -50 180 value window_samples;
#X dropdown 500 440 6 1 0 1 Samples - p-resynth-window-samples 1,
f 6;
#X obj -100 210 select 1024 2048 4096 8192 16384;
#X msg -100 240 0;
#X msg -60 240 1;
#X msg -20 240 2;
#X msg 20 240 3;
#X msg 60 240 4;
#X obj -100 30 loadbang;
#X msg -100 120 1024;
#X obj -100 60 trigger b b;
#X obj 150 210 samplerate~;
#X obj 150 240 expr 1000 / \\$f1 * window_samples;
#X obj 160 330 value frame_ms;
#X text -180 0 UI and DSP stuff;
#X msg 180 300 set \$1;
#X text 410 470 Frame Size:;
#X floatatom 500 470 5 0 0 1 ms - - 0 0 0, f 5;
#X obj 150 180 bang;
#X msg -60 90 names 1024 2048 4096 8192 16384;
#X obj 150 360 s p-resynth-frame-ms;
#X obj 150 270 trigger f f f;
#X obj 1310 150 value frequency;
#X obj 200 560 value frequency1;
#X connect 11 0 91 0;
#X connect 12 0 50 0;
#X connect 15 0 6 0;
#X connect 18 0 17 0;
#X connect 19 0 18 0;
#X connect 19 0 54 0;
#X connect 22 0 24 0;
#X connect 23 0 25 0;
#X connect 24 0 81 0;
#X connect 25 0 81 1;
#X connect 26 0 22 0;
#X connect 27 0 26 0;
#X connect 27 1 23 0;
#X connect 28 0 32 0;
#X connect 29 0 82 0;
#X connect 32 0 33 0;
#X connect 33 0 81 2;
#X connect 39 0 34 0;
#X connect 39 0 76 0;
#X connect 40 0 35 0;
#X connect 40 0 77 0;
#X connect 41 0 15 0;
#X connect 41 0 112 0;
#X connect 42 0 37 0;
#X connect 43 0 42 0;
#X connect 43 0 52 0;
#X connect 44 0 38 0;
#X connect 45 0 53 0;
#X connect 45 0 75 0;
#X connect 49 0 14 0;
#X connect 49 0 14 1;
#X connect 60 0 56 0;
#X connect 60 0 78 0;
#X connect 61 0 60 0;
#X connect 61 0 66 0;
#X connect 62 0 39 0;
#X connect 62 0 64 0;
#X connect 63 0 40 0;
#X connect 63 0 65 0;
#X connect 67 0 80 0;
#X connect 68 0 76 0;
#X connect 68 0 77 0;
#X connect 68 0 78 0;
#X connect 70 0 72 0;
#X connect 71 0 73 0;
#X connect 72 0 74 0;
#X connect 73 0 70 0;
#X connect 73 1 72 1;
#X connect 75 0 44 0;
#X connect 80 0 68 0;
#X connect 81 0 29 0;
#X connect 82 0 14 0;
#X connect 82 0 14 1;
#X connect 84 0 87 0;
#X connect 84 0 113 0;
#X connect 87 0 83 0;
#X connect 89 0 90 0;
#X connect 89 0 92 0;
#X connect 89 0 108 0;
#X connect 92 0 93 0;
#X connect 92 1 94 0;
#X connect 92 2 95 0;
#X connect 92 3 96 0;
#X connect 92 4 97 0;
#X connect 93 0 11 0;
#X connect 94 0 11 0;
#X connect 95 0 11 0;
#X connect 96 0 11 0;
#X connect 97 0 11 0;
#X connect 98 0 100 0;
#X connect 99 0 89 0;
#X connect 100 0 99 0;
#X connect 100 1 109 0;
#X connect 101 0 102 0;
#X connect 102 0 111 0;
#X connect 105 0 107 0;
#X connect 108 0 101 0;
#X connect 109 0 91 0;
#X connect 111 0 110 0;
#X connect 111 1 103 0;
#X connect 111 2 105 0;
#X coords 0 -1 1 1 960 510 2 400 200;
#X restore 100 100 pd ui;
#N canvas 0 49 1920 1009 title 0;
#X obj 200 100 cnv 15 960 30 empty empty Harmonic\ Reynthesis\ for\ Mini\ Clavier
12 12 0 14 #842a2a #ffffff 0;
#X coords 0 -1 1 1 960 30 2 200 100;
#X restore 100 70 pd title;
#X text 1100 100 TODO: Add ADSR envelope for previewing samples without
release, f 64;
