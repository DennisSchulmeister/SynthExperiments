#N canvas 0 49 1920 1009 12;
#X obj -30 -30 preset_hub k12 1 %hidden%;
#X obj 500 10 inlet;
#X obj 520 1370 vline~;
#X obj 520 1430 outlet~;
#X obj 500 1040 spigot;
#X obj 560 1040 r \$0-enable-output;
#X text 510 1320 ---- Feed vline~ with three element lists ----;
#X obj 540 400 trigger l b;
#X obj 820 400 trigger l b;
#X text 630 400 Start;
#X text 910 400 End;
#X text 750 360 Set parameters;
#X obj 670 360 s \$0-error;
#X obj 680 320 s \$0-error;
#X text 760 320 Parse input list;
#X obj 1200 950 r \$0-error;
#X text 1200 930 ---- Log error messages ----;
#X obj 560 610 unpack f f;
#X obj 560 670 pack f f f;
#X text 570 840 ---- Append to list ---;
#X obj 840 610 unpack f f;
#X text 850 840 ---- Append to list ---;
#X text 550 560 ---- Build list entries ----;
#X text 830 560 ---- Build list entries ----;
#X text 1100 660 <-- Target value \, Duration [ms] \, Initial delay
[ms];
#X text 1100 610 <-- Target value \, Duration [ms];
#X obj 1200 980 print [envgen~] unknown message;
#X obj 560 700 trigger l l;
#X obj 580 730 unpack f f f;
#X obj 650 640 r \$0-delay;
#X obj 640 760 +;
#X obj 640 790 s \$0-delay;
#X obj 840 670 pack f f f;
#X obj 840 700 trigger l l;
#X obj 860 730 unpack f f f;
#X obj 930 640 r \$0-delay;
#X obj 920 760 +;
#X obj 920 790 s \$0-delay;
#X obj 500 50 route symbol;
#X obj 500 80 list trim 1;
#X obj 800 1430 outlet;
#X obj 1100 1430 outlet;
#X text 510 300 ---- Handle received message ----;
#X obj 800 1400 delay;
#X text 510 1090 ---- Set delay for a bang at the end ----;
#X obj 800 1370 r \$0-finished-delay;
#X obj 530 1270 s \$0-finished-delay;
#X obj 500 1110 trigger l l;
#X obj 580 1210 unpack f f f;
#X obj 640 1241 +;
#X obj 530 1150 trigger b l b;
#X msg 740 1180 \; \$0-finished-delay stop;
#X obj 640 1240 s \$0-finished-delay;
#X text 680 1240 Only last value needed;
#X obj 500 210 trigger a a;
#X obj 530 250 s \$0-echo-outlet;
#X obj 1100 1370 r \$0-echo-outlet;
#X obj 500 110 route list;
#X obj 540 580 ./foreach-list-split 2;
#X obj 820 580 ./foreach-list-split 2;
#X obj 560 1180 ./foreach-list-split 3;
#X obj 500 1340 ./foreach-list-split 3;
#X text 510 190 ---- Mirror received message on the echo outlet ----
;
#X text 10 150 v0 \, v1 \, ... Values, f 55;
#X text 10 170 d0 \, d1 \, ... Durations to reach those values, f
55;
#X text 10 210 The [envgen-gui] abstraction can be used to display
a graphical envelope editor in the parent patch., f 55;
#X text 10 260 The following messages trigger the envelope:, f 55
;
#X text 10 310 [release(, f 55;
#X text 10 290 [attack(, f 55;
#X text 10 340 [attack( triggers the attack envelope that should normally
be defined as to end on a value greater than zero., f 55;
#X text 10 400 [release( triggers the release envelope which should
be defined to reach zero.;
#X text 10 490 1 - Envelope output, f 55;
#X text 10 510 2 - Bang on finish of an envelope, f 55;
#X text 10 530 3 - Received messages, f 55;
#X text 10 560 The second outlet sends a bang \, when the start or
end envelope has finished. This is meant to be able to disable DSP
processing when a note has stopped playing., f 55;
#X text 10 620 The third outlet simply echoes all received messages
on the inlet. This is meant for two-way data binding between the [envgen~]
and [envgen-gui] objects., f 55;
#X text 10 100 [set attack v0 d0 v1 d1 ...(, f 55;
#X text 10 120 [set release v0 d0 v1 d1 ...(, f 55;
#X obj 500 320 route set attack release;
#X obj 520 360 route attack release;
#X text 1100 360 Attack envelope;
#X text 1400 360 Release envelope;
#X obj 560 860 s \$0-list-attack-1;
#X obj 840 860 s \$0-list-release-1;
#X text 500 930 ---- Lists storing the attack and release envelopes
----;
#X obj 500 950 r \$0-list-attack-1;
#X obj 640 950 r \$0-list-attack-2;
#X obj 800 950 r \$0-list-release-1;
#X obj 950 950 r \$0-list-release-2;
#X obj 0 0 cnv 15 400 30 empty empty Flexible\ Envelope\ Generator
10 12 0 14 #e0e0e0 #404040 0;
#X obj 0 460 cnv 15 400 15 empty empty Outlets 10 5 0 12 #e0e0e0 #404040
0;
#X obj 500 140 trigger a;
#X text 10 40 Creates flexible linear envelopes for note start/end.
For this the envelopes must be defined in advance with the following
messages:, f 55;
#X listbox 500 1010 20 0 0 0 - - - 0 0 1, f 20;
#X listbox 800 1010 20 0 0 0 - - - 0 0 1, f 20;
#X obj 500 980 list prepend;
#X obj 800 980 list prepend;
#X obj 570 430 \$0;
#X obj 850 430 \$0;
#X msg 570 460 \; \$1-enable-output 0 \; \$1-list-attack-2 bang \;
\$1-delay 0;
#X msg 850 460 \; \$1-enable-output 0 \; \$1-list-release-2 bang \;
\$1-delay 0;
#X obj 1060 360 \$0;
#X obj 1360 360 \$0;
#X msg 1060 390 \; \$1-enable-output 1 \; \$1-list-attack-1 bang;
#X msg 1360 390 \; \$1-enable-output 1 \; \$1-list-release-1 bang;
#X connect 1 0 38 0;
#X connect 2 0 3 0;
#X connect 4 0 47 0;
#X connect 5 0 4 1;
#X connect 7 0 58 0;
#X connect 7 1 97 0;
#X connect 8 0 59 0;
#X connect 8 1 98 0;
#X connect 15 0 26 0;
#X connect 17 0 18 0;
#X connect 17 1 18 1;
#X connect 18 0 27 0;
#X connect 20 0 32 0;
#X connect 20 1 32 1;
#X connect 27 0 82 0;
#X connect 27 1 28 0;
#X connect 28 1 30 0;
#X connect 28 2 30 1;
#X connect 29 0 18 2;
#X connect 30 0 31 0;
#X connect 32 0 33 0;
#X connect 33 0 83 0;
#X connect 33 1 34 0;
#X connect 34 1 36 0;
#X connect 34 2 36 1;
#X connect 35 0 32 2;
#X connect 36 0 37 0;
#X connect 38 0 39 0;
#X connect 38 1 57 0;
#X connect 39 0 57 0;
#X connect 43 0 40 0;
#X connect 45 0 43 0;
#X connect 47 0 61 0;
#X connect 47 1 50 0;
#X connect 48 1 49 0;
#X connect 48 2 49 1;
#X connect 49 0 52 0;
#X connect 50 0 46 0;
#X connect 50 1 60 0;
#X connect 50 2 51 0;
#X connect 54 0 78 0;
#X connect 54 1 55 0;
#X connect 56 0 41 0;
#X connect 57 0 91 0;
#X connect 57 1 91 0;
#X connect 58 0 17 0;
#X connect 59 0 20 0;
#X connect 60 0 48 0;
#X connect 61 0 2 0;
#X connect 78 0 79 0;
#X connect 78 1 101 0;
#X connect 78 2 102 0;
#X connect 78 3 13 0;
#X connect 79 0 7 0;
#X connect 79 1 8 0;
#X connect 79 2 12 0;
#X connect 85 0 95 0;
#X connect 86 0 95 1;
#X connect 87 0 96 0;
#X connect 88 0 96 1;
#X connect 91 0 54 0;
#X connect 93 0 4 0;
#X connect 93 0 95 1;
#X connect 94 0 4 0;
#X connect 94 0 96 1;
#X connect 95 0 93 0;
#X connect 96 0 94 0;
#X connect 97 0 99 0;
#X connect 98 0 100 0;
#X connect 101 0 103 0;
#X connect 102 0 104 0;
